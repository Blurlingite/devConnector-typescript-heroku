{"ast":null,"code":"//See Section 8 Video 40\n// we bring in axios b/c this is where we make our request\nimport axios from \"axios\";\nimport { setAlert } from \"./alert\"; // import these types from types.js\n\nimport { REGISTER_SUCCESS, REGISTER_FAIL, USER_LOADED, AUTH_ERROR } from \"./types\";\nimport setAuthToken from \"../utils/setAuthToken\"; // Load User\n\nexport const loadUser = () => async dispatch => {\n  // check for token in localStorage and if it's there, pass it to setAuthToken so it can set that global x-auth-token header (in setAuthToken.js)\n  if (localStorage.token) {\n    setAuthToken(localStorage.token);\n  } // make the request\n\n\n  try {\n    // try to get a response by hitting this endpoint (which requires a token which we set with setAuthToken above)\n    const res = await axios.get(\"/api/auth\"); // dispatch the USER_LOADED type along with the data you got from response (res.data)\n\n    dispatch({\n      type: USER_LOADED,\n      payload: res.data\n    });\n  } catch (err) {\n    // dispatch AUTH_ERROR if there is an error\n    dispatch({\n      type: AUTH_ERROR\n    });\n  }\n}; // This will register a User\n// It takes in an object that has a name,email & password\n// We use async await b/c we are making a request\n// Everything on the left of \"async dispatch\" is stuff we take in.\n// Everything on the right of \"async dispatch\" is us preparing what we took in and returning it\n\nexport const register = ({\n  name,\n  email,\n  password\n}) => async dispatch => {\n  // We are building the request and this one needs a Content-Type header b/c we are sending data\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }; // put the stuff we took in into the request body but use JSON format\n\n  const body = JSON.stringify({\n    name,\n    email,\n    password\n  });\n\n  try {\n    // Send this back as the response\n    // 1st param: the endpoint the response will submit to\n    // 2nd param: the stuff in the request body\n    // 3rd param: any configs we need (in this case the variable we made that holds the Content-Type)\n    const res = await axios.post(\"/api/users\", body, config); // the register is successful if your in the try block so dispatch the REGISTER_SUCCESS type\n\n    dispatch({\n      type: REGISTER_SUCCESS,\n      payload: res.data\n    });\n  } catch (err) {\n    // otherwise the register has failed so dispatch the REGISTER_FAIL type\n    // we don't do anything with payload in the types.js so we don't need it here\n    // we want to get the array of errors from the \"err\" in the catch() so we can display them on the webpage. The errors passed into \"err\" comes from our backend that we made earlier in the course\n    // we access the response's data b/c that is where the errors come from by using err.response.data.errors\n    // the array is called \"errors\" (I think we gave it that name somewhere?)\n    const errors = err.response.data.errors; // if there are errors, loop through them\n    // for each error, dispatch the setAlert action (which takes in a message \"error.msg\" and an alertType \"danger\")\n    // setAlert() is an action we made in alert.js in the \"actions\" folder. In alert.js we added a timeout variable in the parameter list but we initialized it in the parameter list so we don't need a 3rd parameter here.\n    // After doing all that, we need to go to Register component in Register.js in our componenets folder and connect this (the auth action) to it\n\n    if (errors) {\n      errors.forEach(error => dispatch(setAlert(error.msg, \"danger\")));\n    }\n\n    dispatch({\n      type: REGISTER_FAIL\n    });\n  }\n};","map":{"version":3,"sources":["/Users/vishnukdawah/Documents/github/MERN-apps/devConnector/client/src/actions/auth.js"],"names":["axios","setAlert","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","AUTH_ERROR","setAuthToken","loadUser","dispatch","localStorage","token","res","get","type","payload","data","err","register","name","email","password","config","headers","body","JSON","stringify","post","errors","response","forEach","error","msg"],"mappings":"AAAA;AACA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,SAAzB,C,CAEA;;AACA,SACEC,gBADF,EAEEC,aAFF,EAGEC,WAHF,EAIEC,UAJF,QAKO,SALP;AAOA,OAAOC,YAAP,MAAyB,uBAAzB,C,CACA;;AACA,OAAO,MAAMC,QAAQ,GAAG,MAAM,MAAMC,QAAN,IAAkB;AAC9C;AACA,MAAIC,YAAY,CAACC,KAAjB,EAAwB;AACtBJ,IAAAA,YAAY,CAACG,YAAY,CAACC,KAAd,CAAZ;AACD,GAJ6C,CAK9C;;;AACA,MAAI;AACF;AACA,UAAMC,GAAG,GAAG,MAAMX,KAAK,CAACY,GAAN,CAAU,WAAV,CAAlB,CAFE,CAIF;;AACAJ,IAAAA,QAAQ,CAAC;AACPK,MAAAA,IAAI,EAAET,WADC;AAEPU,MAAAA,OAAO,EAAEH,GAAG,CAACI;AAFN,KAAD,CAAR;AAID,GATD,CASE,OAAOC,GAAP,EAAY;AACZ;AACAR,IAAAA,QAAQ,CAAC;AACPK,MAAAA,IAAI,EAAER;AADC,KAAD,CAAR;AAGD;AACF,CArBM,C,CAuBP;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMY,QAAQ,GAAG,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,KAAR;AAAeC,EAAAA;AAAf,CAAD,KAA+B,MAAMZ,QAAN,IAAkB;AACvE;AACA,QAAMa,MAAM,GAAG;AACbC,IAAAA,OAAO,EAAE;AACP,sBAAgB;AADT;AADI,GAAf,CAFuE,CAQvE;;AACA,QAAMC,IAAI,GAAGC,IAAI,CAACC,SAAL,CAAe;AAAEP,IAAAA,IAAF;AAAQC,IAAAA,KAAR;AAAeC,IAAAA;AAAf,GAAf,CAAb;;AAEA,MAAI;AACF;AACA;AACA;AACA;AACA,UAAMT,GAAG,GAAG,MAAMX,KAAK,CAAC0B,IAAN,CAAW,YAAX,EAAyBH,IAAzB,EAA+BF,MAA/B,CAAlB,CALE,CAOF;;AACAb,IAAAA,QAAQ,CAAC;AACPK,MAAAA,IAAI,EAAEX,gBADC;AAEPY,MAAAA,OAAO,EAAEH,GAAG,CAACI;AAFN,KAAD,CAAR;AAID,GAZD,CAYE,OAAOC,GAAP,EAAY;AACZ;AACA;AAEA;AACA;AACA;AACA,UAAMW,MAAM,GAAGX,GAAG,CAACY,QAAJ,CAAab,IAAb,CAAkBY,MAAjC,CAPY,CASZ;AACA;AACA;AACA;;AACA,QAAIA,MAAJ,EAAY;AACVA,MAAAA,MAAM,CAACE,OAAP,CAAeC,KAAK,IAAItB,QAAQ,CAACP,QAAQ,CAAC6B,KAAK,CAACC,GAAP,EAAY,QAAZ,CAAT,CAAhC;AACD;;AACDvB,IAAAA,QAAQ,CAAC;AACPK,MAAAA,IAAI,EAAEV;AADC,KAAD,CAAR;AAGD;AACF,CA3CM","sourcesContent":["//See Section 8 Video 40\n// we bring in axios b/c this is where we make our request\nimport axios from \"axios\";\nimport { setAlert } from \"./alert\";\n\n// import these types from types.js\nimport {\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n  USER_LOADED,\n  AUTH_ERROR\n} from \"./types\";\n\nimport setAuthToken from \"../utils/setAuthToken\";\n// Load User\nexport const loadUser = () => async dispatch => {\n  // check for token in localStorage and if it's there, pass it to setAuthToken so it can set that global x-auth-token header (in setAuthToken.js)\n  if (localStorage.token) {\n    setAuthToken(localStorage.token);\n  }\n  // make the request\n  try {\n    // try to get a response by hitting this endpoint (which requires a token which we set with setAuthToken above)\n    const res = await axios.get(\"/api/auth\");\n\n    // dispatch the USER_LOADED type along with the data you got from response (res.data)\n    dispatch({\n      type: USER_LOADED,\n      payload: res.data\n    });\n  } catch (err) {\n    // dispatch AUTH_ERROR if there is an error\n    dispatch({\n      type: AUTH_ERROR\n    });\n  }\n};\n\n// This will register a User\n// It takes in an object that has a name,email & password\n// We use async await b/c we are making a request\n// Everything on the left of \"async dispatch\" is stuff we take in.\n// Everything on the right of \"async dispatch\" is us preparing what we took in and returning it\nexport const register = ({ name, email, password }) => async dispatch => {\n  // We are building the request and this one needs a Content-Type header b/c we are sending data\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  };\n\n  // put the stuff we took in into the request body but use JSON format\n  const body = JSON.stringify({ name, email, password });\n\n  try {\n    // Send this back as the response\n    // 1st param: the endpoint the response will submit to\n    // 2nd param: the stuff in the request body\n    // 3rd param: any configs we need (in this case the variable we made that holds the Content-Type)\n    const res = await axios.post(\"/api/users\", body, config);\n\n    // the register is successful if your in the try block so dispatch the REGISTER_SUCCESS type\n    dispatch({\n      type: REGISTER_SUCCESS,\n      payload: res.data\n    });\n  } catch (err) {\n    // otherwise the register has failed so dispatch the REGISTER_FAIL type\n    // we don't do anything with payload in the types.js so we don't need it here\n\n    // we want to get the array of errors from the \"err\" in the catch() so we can display them on the webpage. The errors passed into \"err\" comes from our backend that we made earlier in the course\n    // we access the response's data b/c that is where the errors come from by using err.response.data.errors\n    // the array is called \"errors\" (I think we gave it that name somewhere?)\n    const errors = err.response.data.errors;\n\n    // if there are errors, loop through them\n    // for each error, dispatch the setAlert action (which takes in a message \"error.msg\" and an alertType \"danger\")\n    // setAlert() is an action we made in alert.js in the \"actions\" folder. In alert.js we added a timeout variable in the parameter list but we initialized it in the parameter list so we don't need a 3rd parameter here.\n    // After doing all that, we need to go to Register component in Register.js in our componenets folder and connect this (the auth action) to it\n    if (errors) {\n      errors.forEach(error => dispatch(setAlert(error.msg, \"danger\")));\n    }\n    dispatch({\n      type: REGISTER_FAIL\n    });\n  }\n};\n"]},"metadata":{},"sourceType":"module"}